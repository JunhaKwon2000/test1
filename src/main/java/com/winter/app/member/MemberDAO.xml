<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <!-- namespace의 이름은 사용하려는 DAO의 풀패키지명과 동일하게 작성 -->
  <mapper namespace="com.winter.app.member.MemberDAO">
  	<resultMap type="MemberVO" id="loginResult">
  		<id column="ID" property="id"/>
  		<result column="PW" property="pw"/>
  		<result column="NAME" property="name"/>
  		<result column="EMAIL" property="email"/>
  		<result column="PHONE" property="phone"/>
  		<result column="BIRTH" property="birth"/>
  		<result column="STATUS" property="status"/>
  		<result column="delete_status" property="deleteStatus"/>
  	</resultMap>
  	<resultMap type="MemberVO" id="getProfile">
  		<id column="id" property="id"/>
  		<result column="pw" property="pw"/>
  		<result column="name" property="name"/>
  		<result column="email" property="email"/>
  		<result column="phone" property="phone"/>
  		<result column="birth" property="birth"/>
  		<result column="status" property="status"/>
  		<result column="delete_status" property="deleteStatus"/>
  		<association property="profileVO" javaType="ProfileVO">
			<result column="ori_name" property="oriName"/>
			<result column="save_name" property="saveName"/>
		</association>
  	</resultMap>
  	
  	<insert id="join" parameterType="MemberVO">
  	INSERT INTO member
  	VALUES(#{id}, #{pw}, #{name}, #{email}, #{phone}, #{birth},1,1)
  	</insert>
  	
  	<select id="login" parameterType="MemberVO" resultMap="loginResult">
  	SELECT *
  		FROM member
  		WHERE ID=#{id}
  	
  	</select>
  	
  	<select id="getPassword" parameterType="MemberVO" resultType="string">
  		SELECT pw
  		 FROM member 
  		 WHERE id = #{id}
  	</select>
  	
  	<update id="updatePassword" parameterType="MemberVO">
  		UPDATE member
  		SET pw = #{pw}
  		WHERE id = #{id}
  	</update>
  	
  	<update id="memberChange" parameterType="MemberVO">
  		UPDATE member
  		SET name = #{name},
  			email = #{email},
  			phone = #{phone}
  		WHERE id = #{id}
  	</update>
  	
  	<insert id="addFile" parameterType="ProfileVO">
  		INSERT INTO profile
  		VALUES (#{id},#{saveName},#{oriName})
  	</insert>
  	
  	<select id="getProfile" parameterType="MemberVO" resultMap="getProfile">
  		SELECT *
  		FROM member m JOIN profile p ON m.id = p.id
  		WHERE m.id= #{id}
  		
  	</select>
  	<update id="memberDelete" parameterType="MemberVO">
  		UPDATE member
  		SET delete_status = 0
  		WHERE id = #{id}
  	</update>
  	
  	
  	</mapper>